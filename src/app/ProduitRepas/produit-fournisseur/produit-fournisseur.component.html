<p-toast></p-toast>
<p-confirmDialog [style]="{width: '50vw'}"></p-confirmDialog>
<p-toolbar styleClass="mb-4 gap-2">
    <ng-template pTemplate="left">
       <button pButton pRipple  class="p-button-success mr-2" (click)="show()"><i class="fa fa-plus" aria-hidden="true"></i></button>

        <button pButton pRipple  class="p-button-danger" (click)="deleteSelectedProducts()" [disabled]="!selectedProducts || !selectedProducts.length"><i class="fa fa-trash"></i></button>
    </ng-template>

    <ng-template pTemplate="right">
        <p-fileUpload mode="basic" accept="image/*" [maxFileSize]="1000000" label="Import" chooseLabel="Import" class="mr-2 inline-block"></p-fileUpload>
        <button pButton pRipple label="Export" icon="pi pi-upload" class="p-button-help"></button>
    </ng-template>
</p-toolbar>

<p-table
    #dt
    [value]="produit"
    [paginator]="true"
    [rows]="10"
    editMode="row"
    [globalFilterFields]="['nom', 'description']"
    [tableStyle]="{ 'min-width': '75rem' }"
    [(selection)]="selectedProducts"
    [rowHover]="true"
    dataKey="id"
    currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
    [showCurrentPageReport]="true">
    <ng-template pTemplate="caption">
        <div class="flex align-items-center justify-content-between">
            <h5 class="m-0">Manage Products</h5>
            <span class="p-input-icon-left">
                <i class="pi pi-search"></i>
                <input pInputText type="text"  placeholder="Search..." />
            </span>
        </div>
    </ng-template>
    <ng-template pTemplate="header">
        <tr>
            <th pSortableColumn="nom" style="min-width:15rem;width:20%">Name <p-sortIcon field="nom"></p-sortIcon></th>
            <th style="width:20%">Description</th>
            <th pSortableColumn="prix" style="width:20%">Price <p-sortIcon field="prix"></p-sortIcon></th>
            <th style="width:20%">Ingredient</th>
            <th style="width:20%">Categorie du Produit</th>
            <th style="width:20%">Image</th>

            <th></th>
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-produit let-editing="editing" let-ri="rowIndex">
      <tr [pEditableRow]="produit">
        <td>
        <p-cellEditor>
          <ng-template pTemplate="input">
            <input pInputText type="text" [(ngModel)]="produit.nom">
        </ng-template>
          <ng-template pTemplate="output">
          {{produit.nom}}
      </ng-template>
        </p-cellEditor>
      </td>
      <td>
    <p-cellEditor>  <ng-template pTemplate="input">
      <input pInputText type="text" [(ngModel)]="produit.description">
  </ng-template>
    <ng-template pTemplate="output">
    {{produit.description}}
</ng-template>
     </p-cellEditor>
    </td>
       <td>
      <p-cellEditor>
        <ng-template pTemplate="input">
          <input pInputText type="text" [(ngModel)]="produit.prix">
      </ng-template>
        <ng-template pTemplate="output">
        {{produit.prix | currency: 'USD'}}
    </ng-template>
   </p-cellEditor>
  </td>


      <td>
  <p-cellEditor>  <ng-template pTemplate="input">
    <input pInputText type="text" [(ngModel)]="produit.ingredient">
</ng-template>
  <ng-template pTemplate="output">
  {{produit.ingredient}}
</ng-template> </p-cellEditor>
</td>




<td>
  <p-cellEditor>  <ng-template pTemplate="input">
    <select class="form-control" id="categProduit" [(ngModel)]="produit.categorieProduit" name="categProduit" required>
      <option value="proteienes">Proteines</option>
      <option value="vitamines">Vitamines</option>
      <option value="acide">Acides</option>

    </select>
</ng-template>
  <ng-template pTemplate="output">
  {{produit.categorieProduit}}
</ng-template> </p-cellEditor>
</td>



<td>
  <p-cellEditor>  <ng-template pTemplate="input">
    <input type="file" name="image" (change)="onFileSelected($event)">
</ng-template>
  <ng-template pTemplate="output">
    <img [src]="'data:image/jpeg;base64,' + produit.imageBase64" [alt]="produit.nom"/>
</ng-template> </p-cellEditor>
</td>





    <td>
      <p-cellEditor>
          <td><img [src]="'data:image/jpeg;base64,' + produit.imageBase64" [alt]="produit.nom" width="50" class="shadow-4" /></td>

        </p-cellEditor>
      </td>




          <td>
            <button *ngIf="!editing" pButton pRipple type="button" pInitEditableRow icon="pi pi-pencil" (click)="onRowEditInit(produit)" class="p-button-rounded p-button-warning"></button>
            <button *ngIf="editing" pButton pRipple type="button" pSaveEditableRow icon="pi pi-check" (click)="onRowEditSave(produit)" class="p-button-rounded p-button-text p-button-success mr-2"></button>
            <button *ngIf="editing" pButton pRipple type="button" pCancelEditableRow icon="pi pi-times" (click)="onRowEditCancel(produit, ri)" class="p-button-rounded p-button-text p-button-danger"></button>
              <button pButton pRipple icon="pi pi-trash" class="p-button-rounded p-button-danger" (click)="deleteProduit(produit)"></button>
          </td>
      </tr>
  </ng-template>
  <ng-template pTemplate="summary">
      <div class="flex align-items-center justify-content-between">In total there are {{ produit ? produit.length : 0 }} produit.</div>
  </ng-template>
    <ng-template pTemplate="summary">
        <div class="flex align-items-center justify-content-between">In total there are {{ produit ? produit.length : 0 }} products.</div>
    </ng-template>
</p-table>












































